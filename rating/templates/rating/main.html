{% extends "base.html" %}

{% block content %}

    <div class="row">
        <div class="col text-center">
            
        </div>
    </div>
    <div class="row">
        <div class="col text-center">
            <form class="rate-form" action="" method="POST" id="rating-form">
            {% csrf_token %}
            <input type="text" class="form-control" id="order-id" placeholder="Order ID" required minlength="6" maxlength="6">
            <div class="rate-buttons">
                <button type="submit" class="fa fa-star fa-3x my-btn" id="first"></button>
                <button type="submit" class="fa fa-star fa-3x my-btn" id="second"></button>
                <button type="submit" class="fa fa-star fa-3x my-btn" id="third"></button>
                <button type="submit" class="fa fa-star fa-3x my-btn" id="fourth"></button>
                <button type="submit" class="fa fa-star fa-3x my-btn" id="fifth"></button>
            </div>
            <div>
                <input type="textfield" class="form-control" id="review-text" placeholder="Review text">
            </div>
            </form>
        </div>
    </div>
    <div class="row">
        <div class="col text-center">
            <p class="review-text-placeholder">Review text</p>
        </div>
    </div>
<div id="confirm-box"></div>


    <script>
        function validateOrderId() {
            const constraint = {
                pattern: /^\d{6}$/,
                message: "Order ID must have exactly 6 digits, e.g. 123456"
            };
            const orderIdInput = document.getElementById('order-id');

            if (constraint.pattern.test(orderIdInput.value)) {
                orderIdInput.setCustomValidity("");
            } else {
                orderIdInput.setCustomValidity(constraint.message);
            }
            
            // Trigger the browser's built-in validation UI
            orderIdInput.reportValidity();
        }

        document.addEventListener('DOMContentLoaded', function() {
            const orderIdInput = document.getElementById('order-id');
            const ratingForm = document.getElementById('rating-form');
            
            if (orderIdInput && ratingForm) {
                // Validate on input
                orderIdInput.addEventListener('input', validateOrderId);
                
                // Validate on form submission
                ratingForm.addEventListener('submit', function(event) {
                    validateOrderId();
                    if (!orderIdInput.validity.valid) {
                        event.preventDefault();
                    }
                });

                // Update form ID when order ID changes
                orderIdInput.addEventListener('input', function() {
                    ratingForm.id = this.value || 'rating-form';
                });
            }
        });
    </script>
{% endblock content %}
